SELECT
  child_ns.nspname||'.'|| child.relname
FROM pg_inherits inh
JOIN pg_class   parent    ON parent.oid = inh.inhparent
JOIN pg_class   child     ON child.oid  = inh.inhrelid
JOIN pg_namespace parent_ns ON parent_ns.oid = parent.relnamespace
JOIN pg_namespace child_ns  ON child_ns.oid  = child.relnamespace
WHERE parent.relname = 'claim_core'
  AND parent_ns.nspname = 'claimsprocess_humana'
ORDER BY child_ns.nspname, child.relname;


-- Partition parents
SELECT
  ns.nspname AS parent_schema,
  c.relname AS parent_table,
  p.partstrat AS partition_strategy,
  p.partnatts AS partition_key_columns_count
FROM pg_partitioned_table p
JOIN pg_class c ON c.oid = p.partrelid
JOIN pg_namespace ns ON ns.oid = c.relnamespace
ORDER BY ns.nspname, c.relname;


-- Partition children
SELECT n.nspname   AS schema_name,
       c.relname   AS child_table,
       pg_get_expr(c.relpartbound, c.oid) AS partition_bound,
       p_parent.relname AS parent_table
FROM pg_class c
JOIN pg_namespace n ON n.oid = c.relnamespace
JOIN pg_inherits i ON i.inhrelid = c.oid
JOIN pg_class p_parent ON p_parent.oid = i.inhparent
ORDER BY n.nspname, p_parent.relname, c.relname;


