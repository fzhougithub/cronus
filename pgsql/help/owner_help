SELECT nspname AS schema_name, 
       rolname AS owner_name
FROM pg_namespace n
JOIN pg_roles r ON n.nspowner = r.oid
WHERE nspname = 'claimsprocess_humana';



SELECT
    t.tgname AS trigger_name,
    c.relname AS table_name,
    r.rolname AS table_owner
FROM
    pg_trigger t
JOIN
    pg_class c ON t.tgrelid = c.oid
JOIN
    pg_roles r ON c.relowner = r.oid
WHERE
    r.rolname = current_user
    AND t.tgisinternal = FALSE  -- Exclude triggers used internally by the system (like foreign key triggers)
ORDER BY
    table_name, trigger_name;


SELECT
    schemaname,
    viewname,
    viewowner
FROM
    pg_views
WHERE
    viewowner = current_user
ORDER BY
    schemaname, viewname;


SELECT
    s.subname AS subscription_name,
    d.datname AS database_name,
    a.rolname AS subscription_owner
FROM
    pg_subscription s
JOIN
    pg_database d ON s.subdbid = d.oid
JOIN
    pg_authid a ON s.subowner = a.oid
WHERE
    a.rolname != 'postgres';


select 'alter table '||schemaname||'.'||tablename||' owner to postgres;' from pg_tables where tableowner='fzhou';

WITH schema_owner AS (
  SELECT nspname, nspowner
  FROM pg_namespace
  WHERE nspname = 'datamart_humana'
),
objects AS (
  SELECT c.oid, c.relkind, c.relname, c.relowner
  FROM pg_class c
  JOIN pg_namespace n ON c.relnamespace = n.oid
  WHERE n.nspname = 'datamart_humana'
  UNION ALL
  SELECT p.oid, 'f'::"char" AS relkind, p.proname AS relname, p.proowner AS relowner
  FROM pg_proc p
  JOIN pg_namespace n ON p.pronamespace = n.oid
  WHERE n.nspname = 'datamart_humana'
)
SELECT
  o.relkind,
  o.relname,
  pg_catalog.pg_get_userbyid(o.relowner) AS current_owner,
  pg_catalog.pg_get_userbyid(so.nspowner) AS schema_owner
FROM objects o
CROSS JOIN schema_owner so
WHERE o.relowner <> so.nspowner;

SELECT
    relname,
    pg_get_userbyid(relowner) AS owner_name
FROM
    pg_class
WHERE
    relkind = 'r';


