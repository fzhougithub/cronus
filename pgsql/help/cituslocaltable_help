SELECT 
    n.nspname AS schema_name,
    c.relname AS table_name
FROM pg_class c
JOIN pg_namespace n ON n.oid = c.relnamespace
WHERE c.relkind = 'r'               -- Ordinary tables
  AND c.relispartition = false     -- Exclude child partitions
  AND n.nspname NOT IN ('pg_catalog', 'information_schema', 'citus')
  AND NOT EXISTS (                 -- The "Local Only" filter
      SELECT 1 
      FROM pg_dist_partition p 
      WHERE p.logicalrelid = c.oid
  )
  AND NOT EXISTS (                 -- Exclude parents of partitions
      SELECT 1 FROM pg_inherits i WHERE i.inhparent = c.oid
  )
ORDER BY schema_name, table_name;


